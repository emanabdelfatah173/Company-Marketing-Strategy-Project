--  company_marketing DB
USE [company_marketing]
GO

-- Create Tables

CREATE TABLE [dbo].[customer](
	[c_id] [int] NOT NULL,
	[year_birth] [int] NOT NULL,
	[education] [varchar](50) NOT NULL,
	[marital_statues] [varchar](50) NOT NULL,
	[income] [decimal](18, 2) NOT NULL,
	[kidhome] [int] NULL,
	[teenhome] [int] NULL,
	[dt_of_enroll] [date] NOT NULL,
	[recnency] [int] NOT NULL,
	[complain] [varchar](50) NULL,
 CONSTRAINT [PK_customer] PRIMARY KEY CLUSTERED 
(
	[c_id] ASC
))


INSERT INTO customer ( c_id,year_Birth,	Education, marital_statues, Income,	Kidhome, Teenhome, dt_of_enroll, recnency, Complain
 )  
VALUES (1,1985,'PhD','Married',33454,1,2,'2013-05-08 00:00:00',32,0),
	(2,1987,'Graduation','Married',17323,0,3,'2012-10-10 00:00:00',38,0),
	(3,1989,'Graduation','Married',38360,1,0,'2013-05-31 00:00:00',26,0),
	(4,1989,'Master','Divorced',10979,0,1,'2014-05-22 00:00:00',34,0),
	(5,1985,'Master','Married',20559,1,3,'2013-03-12 00:00:00',88,0),
	(6,1988,'Graduation','Single',27938,0,0,'2014-04-28 00:00:00',31,0),
	(7,1985,'Graduation','Single',29760,0,0,'2012-08-29 00:00:00',87,0),
	(8,1987,'Graduation','Divorced',81361,0,2,'2014-02-25 00:00:00',18,0),
	(9,1991,'PhD','Single',68126,0,0,'2012-11-10 00:00:00',40,0),
	(10,1991,'Graduation','Single',86037,0,0,'2013-01-02 00:00:00',3,0),
	(11,1985,'Master','Married',19510,2,0,'2013-09-04 00:00:00',63,0),
	(12,1992,'Master','Single',92859,0,0,'2012-10-19 00:00:00',46,0),
	(13,1988,'Graduation','Single',66951,0,0,'2013-11-02 00:00:00',46,0),
	(14,1988,'Graduation','Married',38872,1,1,'2013-05-30 00:00:00',93,1),
	(15,1985,'Graduation','Married',70951,0,1,'2013-05-04 00:00:00',66,0),
	(16,1990,'Graduation','Married',73687,0,1,'2013-11-28 00:00:00',8,0),
	(17,1988,'PhD','Married',67546,0,2,'2012-08-31 00:00:00',90,0),
	(18,1985,'Graduation','Single',29938,0,0,'2013-10-27 00:00:00',52,0),
	(19,1986,'PhD','Single',69867,0,0,'2013-04-02 00:00:00',30,0),
	(20,1988,'Graduation','Single',39747,0,0,'2014-04-13 00:00:00',43,0),
	(21,1985,'Graduation','Single',66503,0,0,'2012-08-14 00:00:00',30,0),
	(22,1986,'PhD','Single',29999,0,0,'2013-02-13 00:00:00',22,0),
	(23,1989,'PhD','Single',33996,0,0,'2013-09-11 00:00:00',46,0),
	(24,1988,'Graduation','Single',68655,0,0,'2012-08-10 00:00:00',95,3),
	(25,1986,'Graduation','Divorced',41411,0,0,'2013-12-07 00:00:00',11,0),
	(26,1986,'Graduation','Married',71952,1,0,'2013-01-10 00:00:00',93,1),
	(27,1989,'Graduation','Single',30279,0,0,'2012-12-30 00:00:00',13,0),
	(28,1985,'Graduation','Married',19986,1,0,'2013-11-14 00:00:00',74,0),
	(29,1993,'Graduation','Single',74293,0,0,'2014-05-04 00:00:00',66,0),
	(30,1987,'Graduation','Single',23442,0,0,'2012-12-24 00:00:00',71,0),
	(31,1987,'Graduation','Single',46923,0,0,'2012-08-22 00:00:00',90,0),
	(32,1986,'Graduation','Married',92910,0,3,'2014-04-24 00:00:00',42,0),
	(33,1989,'Graduation','Married',75433,1,2,'2014-04-05 00:00:00',28,0),
	(34,1989,'Graduation','Married',42387,1,2,'2012-10-29 00:00:00',42,0),
	(35,1989,'Graduation','Married',28691,1,1,'2013-07-04 00:00:00',56,0),
	(36,1989,'Graduation','Single',30279,0,0,'2012-12-30 00:00:00',13,0),
	(37,1988,'Graduation','Single',20518,0,0,'2014-05-18 00:00:00',58,0),
	(38,1999,'Undergraduate','Married',24279,0,0,'2012-12-29 00:00:00',6,0),
	(39,1985,'PhD','Married',64355,1,3,'2012-08-24 00:00:00',66,0),
	(40,1989,'Graduation','Single',81217,0,0,'2013-07-19 00:00:00',77,0),
	(41,1992,'Graduation','Married',34935,0,1,'2013-06-21 00:00:00',71,0),
	(42,1990,'Graduation','Single',26095,0,0,'2013-06-30 00:00:00',77,0),
	(43,1987,'Master','Single',73454,0,0,'2014-03-01 00:00:00',95,3),
	(44,1991,'Graduation','Married',42691,0,0,'2013-08-16 00:00:00',48,0),
	(45,1987,'Graduation','Married',25545,1,2,'2012-09-08 00:00:00',35,0),
	(46,1986,'Graduation','Married',32880,1,2,'2012-12-04 00:00:00',76,0),
	(47,1989,'Graduation','Single',21474,0,0,'2014-04-08 00:00:00',0,0),
	(48,1986,'Master','Single',21888,0,0,'2012-12-29 00:00:00',15,0),
	(49,1985,'Graduation','Married',19986,1,1,'2013-11-14 00:00:00',74,0),
	(50,2000,'Undergraduate','Single',21063,0,0,'2013-09-25 00:00:00',34,0);


-----------------------------------------------------------
CREATE TABLE [dbo].[place](
	[id] [int] NOT NULL,
	[name] [varchar](50) NOT NULL,
	[num_of_interest] [int] NOT NULL,
 CONSTRAINT [PK_place] PRIMARY KEY CLUSTERED 
(
	[id] ASC
))
INSERT INTO place (id, name, num_of_interest)
VALUES (100,'WebPurchases',10000),
	(200,'Catalog',7000),
	(300,'Store',8500),
	(400,'WebVisits',25000);

	----------------------------------------------------
	
CREATE TABLE [dbo].[product](
	[id] [int] NOT NULL,
	[name] [nchar](10) NULL,
	[price] [decimal](18, 2) NULL,
 CONSTRAINT [PK_product] PRIMARY KEY CLUSTERED 
(
	[id] ASC
))
INSERT INTO product (id, name, price) 
VALUES (123, 'Milk',24.5),
	(124,'Fruit',40),
	(125,'Meat',350),
	(126,'Fish',120),
	(127,'Sweet',30);

	--------------------------------------------------



	CREATE TABLE [dbo].[promotion](
	[campaign_num] [int] NOT NULL,
	[name] [varchar](50) NOT NULL,
	[date_of_start] [date] NOT NULL,
	[date_of_end] [date] NOT NULL,
 CONSTRAINT [PK_promotion] PRIMARY KEY CLUSTERED 
(
	[campaign_num] ASC
))
INSERT INTO dbo.promotion(campaign_num,name, date_of_start, date_of_end) 
VALUES (1,'fruit and sweets', '1/1/2018', '2018-01-02 00:00:00'),
	(2,'meet and fishs','3/5/2019','3/6/2019'),
	(3,'milk with fruit','2020-05-05 00:00:00', '2020-05-06 00:00:00'),
	(4,'sweet lovers','2023-05-06 00:00:00', '2023-05-07 00:00:00'),
	(5,'stay fit and use our products','2021-06-07 00:00:00','2021-06-08 00:00:00'),
	(6,'stay tund  fish and meet discount','2015-11-08 00:00:00', '2015-11-09 00:00:00'),
	(7,'milk with fruit discount','2016-10-09 00:00:00', '2016-10-10 00:00:00'),
	(8,'sweet lovers discount', '2017-08-10 00:00:00', '2017-08-11 00:00:00'),
	(9,'fruit and sweets discount','2022-04-11 00:00:00','2022-04-12 00:00:00');



	--------------------------------------------------------------------------


CREATE TABLE [dbo].[target](
	[target_date] [int] NOT NULL,
	[target_of_promotion] [int] NOT NULL,
	[target_of_place] [int] NOT NULL,
 CONSTRAINT [PK_target] PRIMARY KEY CLUSTERED 
(
	[target_date] ASC
))INSERT INTO target (target_date, target_of_promotion, target_of_place)
VALUES (2015,500000,15000),
	(2016,600000,20000),
	(2017,300000,27000),
	(2018,400000,25000),
	(2019,425000,30000),
	(2020,335000,17000),
	(2021,450000,18000),
	(2022,550000,19000),
	(2023,650000,30000);

-------------------------------------------------------
CREATE TABLE [dbo].[cust_place](
	[c_id] [int] NOT NULL,
	[place_id] [int] NOT NULL,
 CONSTRAINT [PK_cust_place] PRIMARY KEY CLUSTERED 
(
	[c_id] ASC,
	[place_id] ASC
))

INSERT INTO cust_place VALUES (1,124),
(1,123),
(1,125),
(2,123),
(2,124),
(2,125),
(2,126),
(2,127),
(3,126),
(4,123),
(4,127),
(5,126),
(5,127),
(7,125),
(7,127),
(8,125),
(9,123),
(9,127),
(10,123),
(10,126),
(10,125),
(11,123),
(13,125),
(13,126),
(13,127),
(14,125),
(14,126),
(16,126),
(17,127),
(18,123),
(19,127),
(19,123),
(20,126),
(20,125),
(21,126),
(22,127),
(22,124),
(23,125),
(24,126),
(24,127),
(25,124),
(25,125),
(25,127),
(25,123),
(26,123),
(26,125),
(27,127),
(27,125),
(28,123),
(28,124),
(29,125),
(30,123),
(30,124),
(30,125),
(31,126),
(31,127),
(32,125),
(32,126),
(33,125),
(35,126),
(35,127),
(36,125),
(36,126),
(36,127),
(37,123),
(37,125),
(39,124),
(40,126),
(40,127),
(40,125),
(41,123),
(42,127),
(43,126),
(43,127),
(43,124),
(43,123),
(44,125),
(45,126),
(45,127),
(45,123),
(45,124),
(46,125),
(47,125),
(48,123),
(49,125),
(50,126),
(50,127),
(50,124);

------------------------------------------



CREATE TABLE [dbo].[cust_prod](
	[c_id] [int] NOT NULL,
	[prod_id] [int] NOT NULL,
	[Amount] [int] NOT NULL,
	[date] [datetime] NOT NULL,
 CONSTRAINT [PK_cust_prod] PRIMARY KEY CLUSTERED 
(
	[c_id] ASC,
	[prod_id] ASC
))
INSERT INTO cust_prod VALUES (1,123,56,'2020-12-01 00:00:00'),
(1,124,17,'2020-12-02 00:00:00'),
(1,125,42,'2020-12-03 00:00:00'),
(1,126,10,'2020-12-04 00:00:00'),
(1,127,29,'2020-12-05 00:00:00'),
(2,123,8,'2020-12-06 00:00:00'),
(2,124,68,'2020-12-07 00:00:00'),
(2,125,424,'2020-12-08 00:00:00'),
(2,126,311,'2020-12-09 00:00:00'),
(2,127,125,'2020-12-10 00:00:00'),
(3,123,7,'2020-12-11 00:00:00'),
(3,124,921,'2020-12-12 00:00:00'),
(3,125,305,'2020-12-03 00:00:00'),
(3,126,21,'2021-12-04 00:00:00'),
(3,127,554,'2022-12-01 00:00:00'),
(4,123,503,'2020-12-06 00:00:00'),
(4,124,768,'2022-12-07 00:00:00'),
(4,125,7,'2020-12-08 00:00:00'),
(4,126,512,'2023-12-01 00:00:00'),
(4,127,93,'2022-12-02 00:00:00'),
(5,123,128,'2020-12-01 00:00:00'),
(5,124,59,'2022-02-02 00:00:00'),
(5,125,15,'2018-12-03 00:00:00'),
(5,126,832,'2015-12-02 00:00:00'),
(5,127,38,'2019-12-05 00:00:00'),
(6,123,1,'2021-12-06 00:00:00'),
(6,124,1,'2020-12-07 00:00:00'),
(6,125,21,'2022-12-08 00:00:00'),
(6,126,2,'2019-12-09 00:00:00'),
(6,127,0,'2017-12-03 00:00:00'),
(7,123,1,'2020-12-03 00:00:00'),
(7,127,5,'2021-01-01 00:00:00'),
(8,125,65,'2021-01-02 00:00:00'),
(9,124,51,'2021-01-03 00:00:00'),
(9,127,20,'2021-01-04 00:00:00'),
(10,124,4,'2021-01-05 00:00:00'),
(10,126,61,'2021-01-06 00:00:00'),
(10,127,76,'2021-01-07 00:00:00'),
(11,123,19,'2021-01-08 00:00:00'),
(11,127,87,'2021-01-09 00:00:00'),
(12,124,13,'2021-01-10 00:00:00'),
(12,125,38,'2021-01-11 00:00:00'),
(12,127,2,'2021-01-12 00:00:00'),
(13,124,130,'2021-01-03 00:00:00'),
(13,125,13,'2021-01-04 00:00:00'),
(13,126,3,'2021-01-05 00:00:00'),
(13,127,5,'2021-01-06 00:00:00'),
(14,123,0,'2021-01-07 00:00:00'),
(14,125,118,'2021-01-08 00:00:00'),
(14,126,3,'2021-01-09 00:00:00'),
(15,123,107,'2021-01-02 00:00:00'),
(15,125,4,'2021-01-01 00:00:00'),
(16,126,2,'2021-01-02 00:00:00'),
(17,127,91,'2021-01-03 00:00:00'),
(18,123,6,'2021-01-04 00:00:00'),
(18,124,78,'2021-01-05 00:00:00'),
(19,126,103,'2021-01-06 00:00:00'),
(19,127,34,'2021-01-07 00:00:00'),
(19,123,4,'2021-01-08 00:00:00'),
(20,124,0,'2023-01-09 00:00:00'),
(20,125,4,'2021-01-03 00:00:00'),
(21,126,1,'2022-01-01 00:00:00'),
(21,127,62,'2021-02-01 00:00:00'),
(21,123,38,'2021-02-02 00:00:00'),
(22,124,40,'2021-02-03 00:00:00'),
(22,124,10,'2021-02-04 00:00:00'),
(23,125,1,'2021-02-05 00:00:00'),
(24,126,14,'2021-02-06 00:00:00'),
(24,127,17,'2021-02-07 00:00:00'),
(24,124,12,'2021-02-08 00:00:00'),
(25,124,6,'2021-02-09 00:00:00'),
(25,125,0,'2021-02-10 00:00:00'),
(25,126,3,'2021-02-11 00:00:00'),
(25,127,2,'2021-02-12 00:00:00'),
(25,123,3,'2021-02-03 00:00:00'),
(26,123,128,'2021-02-01 00:00:00'),
(26,125,59,'2021-02-05 00:00:00'),
(27,127,15,'2021-02-06 00:00:00'),
(27,126,832,'2021-02-07 00:00:00'),
(27,125,38,'2021-02-08 00:00:00'),
(28,123,455,'2021-02-09 00:00:00'),
(28,124,14,'2023-02-02 00:00:00'),
(29,125,5,'2021-02-01 00:00:00'),
(29,126,335,'2021-02-02 00:00:00'),
(29,127,6,'22/3/2021'),
(30,123,54,'2021-02-04 00:00:00'),
(30,124,792,'2021-02-05 00:00:00'),
(30,125,297,'2021-02-06 00:00:00'),
(31,126,235,'2021-02-02 00:00:00'),
(31,127,13,'2021-02-08 00:00:00'),
(32,125,14,'2021-03-01 00:00:00'),
(32,126,6,'2021-03-02 00:00:00'),
(33,125,21,'2021-03-03 00:00:00'),
(34,124,140,'2021-03-04 00:00:00'),
(34,125,324,'2021-03-05 00:00:00'),
(34,126,66,'2021-03-06 00:00:00'),
(34,127,9,'2021-03-07 00:00:00'),
(35,125,351,'2021-03-08 00:00:00'),
(35,126,64,'2021-03-09 00:00:00'),
(35,127,64,'2021-03-10 00:00:00'),
(36,123,15,'2021-03-11 00:00:00'),
(36,124,24,'2021-03-12 00:00:00'),
(36,125,46,'2021-03-03 00:00:00'),
(36,126,5,'2021-03-01 00:00:00'),
(36,127,11,'2022-03-05 00:00:00'),
(37,123,61,'2022-03-06 00:00:00'),
(37,125,76,'17/7/2022'),
(38,125,19,'13/8/2021'),
(38,126,87,'2021-03-09 00:00:00'),
(39,126,13,'2021-03-02 00:00:00'),
(39,124,38,'2021-03-01 00:00:00'),
(40,126,2,'2021-03-02 00:00:00'),
(40,127,130,'2022-03-03 00:00:00'),
(40,125,13,'2022-03-04 00:00:00'),
(41,123,3,'2023-03-02 00:00:00'),
(41,124,0,'2021-03-06 00:00:00'),
(41,125,4,'2021-03-07 00:00:00'),
(41,126,1,'13/8/2021'),
(42,126,62,'2021-03-09 00:00:00'),
(42,127,38,'2021-03-03 00:00:00'),
(43,126,40,'2021-03-03 00:00:00'),
(43,127,10,'2021-04-01 00:00:00'),
(43,124,1,'2021-04-02 00:00:00'),
(43,123,14,'2021-04-03 00:00:00'),
(44,123,17,'2021-04-04 00:00:00'),
(44,124,7,'2023-04-05 00:00:00'),
(44,125,512,'2021-04-06 00:00:00'),
(45,126,93,'2020-04-07 00:00:00'),
(45,127,128,'2021-04-08 00:00:00'),
(45,123,59,'2021-04-09 00:00:00'),
(45,124,15,'2021-04-10 00:00:00'),
(46,125,0,'2021-04-11 00:00:00'),
(47,125,4,'2022-04-12 00:00:00'),
(48,123,1,'2021-04-03 00:00:00'),
(49,123,62,'2021-04-04 00:00:00'),
(49,124,38,'2021-04-05 00:00:00'),
(49,125,40,'2021-04-06 00:00:00'),
(50,126,10,'2021-04-07 00:00:00'),
(50,127,1,'2022-04-01 00:00:00'),
(50,124,14,'2023-04-09 00:00:00');

-----------------------------------------------------------
CREATE TABLE [dbo].[prod_place](
	[place_id] [int] NOT NULL,
	[prod_id] [int] NOT NULL,
 CONSTRAINT [PK_prod_place] PRIMARY KEY CLUSTERED 
(
	[place_id] ASC,
	[prod_id] ASC
))

INSERT INTO prod_place VALUES (100,123),
(200,124),
(300,125),
(400,126),
(100,127),
(200,123),
(300,124),
(400,125),
(100,126),
(200,127),
(300,123),
(400,124),
(100,125),
(200,126),
(300,127),
(400,123),
(100,124),
(200,125),
(300,126),
(400,127);

-----------------------------------------------------


CREATE TABLE [dbo].[prod_promotion](
	[prod_id] [int] NOT NULL,
	[campaign_num] [int] NOT NULL,
 CONSTRAINT [PK_prod_promotion] PRIMARY KEY CLUSTERED 
(
	[prod_id] ASC,
	[campaign_num] ASC
))

INSERT INTO prod_promotion (campaign_num, prod_id)
VALUES (1,124),
(1,127),
(2,125),
(2,126),
(3,123),
(3,124),
(4,127),
(5,123),
(5,124),
(5,126),
(6,125),
(6,126),
(7,124),
(7,123),
(8,127),
(9,124),
(9,127);


-------------------------------------------------------

CREATE TABLE [dbo].[target_place_prom](
	[target_date] [int] NOT NULL,
	[place_id] [int] NOT NULL,
	[result_of_cam] [nchar](10) NULL,
	[result_of_place] [nchar](10) NULL,
	[campaign_num] [int] NOT NULL,
 CONSTRAINT [PK_target_place_prom] PRIMARY KEY CLUSTERED 
(
	[target_date] ASC
))

INSERT INTO target_place_prom VALUES (2015,100,1,250000,14000),
(2016,200,2,80000,18000),
(2017,300,3,15000,15000),
(2018,400,4,300000,30000),
(2019,200,5,450000,6000),
(2020,400,6,440000,10000),
(2021,100,7,450000,4000),
(2022,300,8,550000,13000),
(2023,200,9,650000,19000);

----------------------------------------------------------------------  